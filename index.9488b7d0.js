const e=JSON.parse(document.getElementById("colors").textContent),t=(e,t,n)=>[e,t,n].map((e=>{const t=e.toString(16);return t.length<2?"0"+t:t})).join(""),n=/^#/,r=/[^\da-f]/g,a=a=>{let i=a.trim().toLowerCase().replace(n,"");return i in e&&(i=e[i]),r.test(i)&&(i=(e=>{const[n,r,a]=e.match(/(0?\.?\d{1,3})%?\b/g)||[],i=[Number(n),Number(r),Number(a)];return i.every((e=>e>=0&&e<=255))?t(...i):""})(i)),3===i.length&&(i+=i),6!==i.length?[!1]:[!0,i]},i=e=>{let t="";for(;e--;)t+=(16*Math.random()|0).toString(16);return t},l=(e,t,n)=>[71,73,70,56,57,97,1,0,1,0,128,0,0,e,t,n,0,0,0,33,249,4,0,0,0,0,0,44,0,0,0,0,1,0,1,0,0,2,2,68,1,0,59],o=(e,t,n)=>"data:image/gif;base64,"+btoa(String.fromCharCode(...l(e,t,n))),c=(e,t,n,r)=>l(e,t,n).map((e=>e.toString(r))).join(" "),{readyStore:s,connect:d,dispatch:h,getState:u,setState:p}=(e=>{let t={},n={},r=[],a=(e,r)=>{if("@dispatch"!==e&&a("@dispatch",[e,r,t[e]]),t[e]){let i;t[e].forEach((a=>{let l=t[e].includes(a)&&a(n,r);l&&"function"!=typeof l.then&&(n={...n,...l},i={...i,...l})})),i&&a("@changed",i)}},i=(e,n)=>((t[e]||(t[e]=[])).push(n),()=>{t[e]=t[e].filter((e=>e!==n))}),l=()=>n,o=e=>a("@set",e);return i("@set",((e,t)=>t)),e.forEach((e=>{e&&e({dispatch:a,on:i,get:l,set:o})})),a("@init"),{dispatch:a,getState:l,setState:o,connect(...e){let t=e.pop();return r.push({keys:e,cb:t}),()=>{r=r.filter((e=>e.cb!==t))}},readyStore:()=>(a("@ready"),i("@changed",((e,t)=>{r.forEach((e=>{e.keys.some((e=>e in t))&&e.cb(n)}))})),Promise.all(r.map((e=>e.cb(n)))))}})([e=>{e.on("@init",(()=>({r:0,g:0,b:0,radix:16,hex:"000000"}))),e.on("set/rgb",((e,[n,r])=>{const{r:a,g:i,b:l}={...e,[n]:r};return{[n]:r,hex:t(a,i,l)}})),e.on("set/hex",((e,t)=>{const n=parseInt(t,16);return{r:n>>16&255,g:n>>8&255,b:255&n,hex:t}}))}]);let f=(e,t)=>{Array.isArray(t)?t.some((t=>f(e,t))):null!=t&&!1!==t&&e.append(t)},g=e=>{let t=new DocumentFragment;return f(t,e.children),t},m=new Map,b=new Set(["ref","children","__ns"]),y=new Set(["innerHTML","value","muted"]),x=(e,t)=>{if("function"==typeof e)return e(t);let n,r;for(n in e="string"==typeof e?t.__ns?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e):e,t)if(!b.has(n))if(r=t[n],m.has(n))m.get(n)(e,r);else if("style"===n)if("string"==typeof r)e.style.cssText=r;else for(n in r)n.startsWith("--")?e.style.setProperty(n,r[n]):e.style[n]=r[n];else y.has(n)||n.startsWith("on")&&n in e?e[n]=r:null==r||"boolean"==typeof r&&!/^(ari|dat)a-/.test(n)?r?e.setAttribute(n,""):e.removeAttribute(n):e.setAttribute(n,r);return f("template"===e.localName?e.content:e,t.children),r=t.ref,r&&("function"==typeof r?r(e):r.current=e),e},v=e=>Object.seal({current:e});const w=()=>x("hex-color-picker",{ref:e=>{d("hex",(t=>{e.color="#"+t.hex})),e.addEventListener("color-changed",(()=>{h("set/hex",e.color.slice(1))}))},class:"a"}),S=({id:t})=>x("datalist",{ref:t=>{const n=x(g,{});for(const t in e)n.append(x("option",{value:e[t],children:t}));t.append(n)},id:t}),k=()=>{const e=v(),t="i"+i(6),n=()=>{const[t,n]=a(e.current.value);t&&h("set/hex",n)};return d("hex",(t=>{e.current.value=t.hex})),x("fieldset",{children:[x("legend",{children:"HEX"}),x("input",{ref:e,list:t,onchange:n,onkeyup:e=>{"Enter"===e.key&&n()},type:"text",value:"ffffff",spellcheck:"false",autoComplete:"on",placeholder:"ffffff"}),x(S,{id:t})]})};const E=({param:e})=>{const t=v(),n=v(),r=t=>{const n=t.target.valueAsNumber;h("set/rgb",[e,n>255?255:n])};return d(e,(r=>{const a=`${r[e]}`;t.current.value=a,n.current.value=a})),x("div",{children:[x("label",{children:x("input",{type:"number",class:"f",max:255,min:0,step:1,ref:t,oninput:r})}),x("label",{children:x("input",{type:"range",class:"g",max:255,min:0,step:1,ref:n,oninput:r})})]})},C=()=>x("fieldset",{children:[x("legend",{children:"RGB"}),x(E,{param:"r"}),x(E,{param:"g"}),x(E,{param:"b"})]});const N=()=>x("fieldset",{children:[x("legend",{children:"Random Color"}),x("button",{type:"button",onclick:()=>{h("set/hex",i(6))},class:"b",children:"Generate"})]});const A=e=>{const t=e.target;t.select(),navigator.clipboard.writeText(t.value)},L=({ref:e})=>x("input",{ref:e,onclick:A,class:"h",type:"text",spellcheck:"false",readOnly:!0}),P=e=>{const t=x("canvas",{width:50,height:50}),n=t.getContext("2d",{alpha:!0,desynchronized:!0});if(n)return n.fillStyle=e,n.arc(25,25,24,0,2*Math.PI),n.stroke(),n.fill(),t.toDataURL("image/png",.1)},I=()=>{const e=v(),n=v(),r=v(),a=v(),i=document.querySelector('link[rel="icon"]');let l;return d("r","g","b","radix",(({r:s,g:d,b:h,radix:u})=>{const p=o(s,d,h),f="#"+t(s,d,h),g=`url(${p})`,m=`background-image: ${g};`,b="display:inline-block;border:1px solid #c6e2f7;border-radius:50%;width:1em;height:1em;"+m;e.current.value=p,n.current.value=m,r.current.value="https://shoonia.github.io/pixel-gif/"+f,a.current.value=c(s,d,h,u),document.body.style.backgroundImage=g,clearTimeout(l),l=setTimeout((()=>{document.title="1x1 Pixel GIF | "+f,history.pushState("","",f),i.href=P(f)||"",console.log("%c  ",b,f)}),300)})),x("fieldset",{children:[x("legend",{children:"Output"}),x("label",{children:x(L,{ref:e})}),x("label",{children:x(L,{ref:n})}),x("div",{class:"c",children:[x("select",{ref:e=>{e.addEventListener("change",(()=>{p({radix:~~e.value})}))},class:"d",children:[x("option",{value:"16",children:"16"}),x("option",{value:"10",children:"10"}),x("option",{value:"8",children:"8"}),x("option",{value:"2",children:"2"})]}),x("label",{children:x(L,{ref:a})})]}),x("label",{children:x(L,{ref:r})})]})};const F=e=>`1x1_#${e.toUpperCase()}.gif`,O=async()=>{const{r:e,g:t,b:n,hex:r}=u(),a=await window.showSaveFilePicker({suggestedName:F(r)});if("granted"===await a.queryPermission()){const r=await a.createWritable();await r.write(new Blob([new Uint8Array(l(e,t,n))],{type:"image/gif"})),await r.close()}},T=e=>{e.addEventListener("click",(()=>{const{r:t,g:n,b:r,hex:a}=u();e.download=F(a),e.href=o(t,n,r)}))},_=()=>{const e="function"==typeof window.showSaveFilePicker?x("button",{type:"button",class:"e",onclick:O,children:"Download"}):x("a",{role:"button",class:"e",ref:T,href:"#",children:"Download"});return x("fieldset",{children:e})},[B,D]=a(location.hash),G=B?D:i(6);history.pushState("","","#"+G),window.addEventListener("popstate",(()=>{const{hex:e}=u(),t=location.hash.slice(1);if(t!==e){const[e,n]=a(t);e&&h("set/hex",n)}})),h("set/hex",G),document.body.append(x((()=>x("main",{children:[x("h1",{children:"One pixel Base64 encoded GIF generator"}),x(w,{}),x(C,{}),x(k,{}),x(N,{}),x(I,{}),x(_,{})]})),{})),s();