const e=JSON.parse(document.getElementById("colors").textContent),t=(e,t,n)=>[e,t,n].map((e=>{const t=e.toString(16);return t.length<2?"0"+t:t})).join(""),n=/^#/,r=/[^\da-f]/g,a=a=>{let o=a.trim().toLowerCase().replace(n,"");return o in e&&(o=e[o]),r.test(o)&&(o=(e=>{const[n,r,a]=e.match(/(0?\.?\d{1,3})%?\b/g)||[],o=[Number(n),Number(r),Number(a)];return o.every((e=>e>=0&&e<=255))?t(...o):""})(o)),3===o.length&&(o+=o),6!==o.length?[!1]:[!0,o]},o=e=>{let t="";for(;e--;)t+=(16*Math.random()|0).toString(16);return t},i=(e,t,n)=>[71,73,70,56,57,97,1,0,1,0,128,0,0,e,t,n,0,0,0,33,249,4,0,0,0,0,0,44,0,0,0,0,1,0,1,0,0,2,2,68,1,0,59],c=(e,t,n)=>"data:image/gif;base64,"+btoa(String.fromCharCode(...i(e,t,n))),l=(e,t,n,r)=>i(e,t,n).map((e=>e.toString(r))).join(" "),{readyStore:s,connect:d,dispatch:h,getState:u,setState:p}=(e=>{let t={},n={},r=[],a=(e,r)=>{if("@dispatch"!==e&&a("@dispatch",[e,r,t[e]]),t[e]){let o;t[e].forEach((a=>{let i=t[e].includes(a)&&a(n,r);i&&"function"!=typeof i.then&&(n={...n,...i},o={...o,...i})})),o&&a("@changed",o)}},o=(e,n)=>((t[e]||(t[e]=[])).push(n),()=>{t[e]=t[e].filter((e=>e!==n))}),i=()=>n,c=e=>a("@set",e);return o("@set",((e,t)=>t)),e.forEach((e=>{e&&e({dispatch:a,on:o,get:i,set:c})})),a("@init"),{dispatch:a,getState:i,setState:c,connect(...e){let t=e.pop();return r.push({keys:e,cb:t}),()=>{r=r.filter((e=>e.cb!==t))}},readyStore:()=>(a("@ready"),o("@changed",((e,t)=>{r.forEach((e=>{e.keys.some((e=>e in t))&&e.cb(n)}))})),Promise.all(r.map((e=>e.cb(n)))))}})([e=>{e.on("@init",(()=>({r:0,g:0,b:0,radix:16,hex:"000000"}))),e.on("set/rgb",((e,[n,r])=>{const{r:a,g:o,b:i}={...e,[n]:r};return{[n]:r,hex:t(a,o,i)}})),e.on("set/hex",((e,t)=>{const n=parseInt(t,16);return{r:n>>16&255,g:n>>8&255,b:255&n,hex:t}}))}]);let f=(e,t)=>{Array.isArray(t)?t.some((t=>f(e,t))):null!=t&&!1!==t&&e.append(t)},g=e=>{let t=new DocumentFragment;return f(t,e.children),t},m=new Map,b=new Set(["ref","children","__ns"]),y=new Set(["innerHTML","value","muted"]),w=(e,t)=>{if("function"==typeof e)return e(t);let n,r;for(n in e="string"==typeof e?t.__ns?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e):e,t)if(!b.has(n))if(r=t[n],m.has(n))m.get(n)(e,r);else if("style"===n)if("string"==typeof r)e.style.cssText=r;else for(n in r)n.startsWith("--")?e.style.setProperty(n,r[n]):e.style[n]=r[n];else y.has(n)||n.startsWith("on")&&n in e?e[n]=r:null==r||"boolean"==typeof r&&!/^(ari|dat)a-/.test(n)?r?e.setAttribute(n,""):e.removeAttribute(n):e.setAttribute(n,r);return f("template"===e.localName?e.content:e,t.children),r=t.ref,r&&("function"==typeof r?r(e):r.current=e),e},v=e=>Object.seal({current:e});const x=()=>w("hex-color-picker",{ref:e=>{d("hex",(t=>{e.color="#"+t.hex})),e.addEventListener("color-changed",(()=>{h("set/hex",e.color.slice(1))}))},class:"a"}),k=({id:t})=>w("datalist",{ref:t=>{const n=w(g,{});for(const t in e)n.append(w("option",{value:e[t],children:t}));t.append(n)},id:t}),S=()=>{const e=v(),t="i"+o(6),n=()=>{const[t,n]=a(e.current.value);t&&h("set/hex",n)};return d("hex",(t=>{e.current.value=t.hex})),w("fieldset",{children:[w("legend",{children:"HEX"}),w("input",{ref:e,list:t,onchange:n,onkeyup:e=>{"Enter"===e.key&&n()},type:"text",value:"ffffff",spellcheck:"false",autoComplete:"on",placeholder:"ffffff"}),w(k,{id:t})]})};const E=({param:e})=>{const t=v(),n=v(),r=t=>{const n=t.target.valueAsNumber;h("set/rgb",[e,n>255?255:n])};return d(e,(r=>{const a=`${r[e]}`;t.current.value=a,n.current.value=a})),w("div",{children:[w("label",{children:w("input",{type:"number",class:"g",max:255,min:0,step:1,ref:t,oninput:r})}),w("label",{children:w("input",{type:"range",class:"h",max:255,min:0,step:1,ref:n,oninput:r})})]})},C=()=>w("fieldset",{children:[w("legend",{children:"RGB"}),w(E,{param:"r"}),w(E,{param:"g"}),w(E,{param:"b"})]});const L=()=>w("fieldset",{children:[w("legend",{children:"Random Color"}),w("button",{type:"button",onclick:()=>{h("set/hex",o(6))},class:"b",children:"Generate"})]});const A=e=>{const t=e.target;t.select(),navigator.clipboard.writeText(t.value)},N=({ref:e})=>w("input",{ref:e,onclick:A,class:"f",type:"text",spellcheck:"false",readOnly:!0}),P=e=>{const t=w("canvas",{width:50,height:50}),n=t.getContext("2d",{alpha:!0,desynchronized:!0});if(n)return n.fillStyle=e,n.arc(25,25,24,0,2*Math.PI),n.stroke(),n.fill(),t.toDataURL("image/png",.1)},$=()=>{const e=v(),n=v(),r=v(),a=v(),o=document.querySelector('link[rel="icon"]');let i;return d("r","g","b","radix",(({r:s,g:d,b:h,radix:u})=>{const p=c(s,d,h),f="#"+t(s,d,h),g=`url(${p})`,m=`background-image: ${g};`,b="display:inline-block;border:1px solid #c6e2f7;border-radius:50%;width:1em;height:1em;"+m;e.current.value=p,n.current.value=m,r.current.value="https://shoonia.github.io/pixel-gif/"+f,a.current.value=l(s,d,h,u),document.body.style.backgroundImage=g,clearTimeout(i),i=setTimeout((()=>{document.title="1x1 Pixel GIF | "+f,history.pushState("","",f),o.href=P(f)||"",console.log("%c  ",b,f)}),300)})),w("fieldset",{children:[w("legend",{children:"Output"}),w("label",{children:w(N,{ref:e})}),w("label",{children:w(N,{ref:n})}),w("div",{class:"c",children:[w("select",{ref:e=>{e.addEventListener("change",(()=>{p({radix:~~e.value})}))},class:"d",children:[w("option",{value:"16",children:"16"}),w("option",{value:"10",children:"10"}),w("option",{value:"8",children:"8"}),w("option",{value:"2",children:"2"})]}),w("label",{children:w(N,{ref:a})})]}),w("label",{children:w(N,{ref:r})})]})};const I=e=>`1x1_#${e.toUpperCase()}.gif`,U=async()=>{const{r:e,g:t,b:n,hex:r}=u(),a=await window.showSaveFilePicker({suggestedName:I(r)});if("granted"===await a.queryPermission()){const r=await a.createWritable();await r.write(new Blob([new Uint8Array(i(e,t,n))],{type:"image/gif"})),await r.close()}},B=e=>{e.addEventListener("click",(()=>{const{r:t,g:n,b:r,hex:a}=u();e.download=I(a),e.href=c(t,n,r)}))},D=()=>{const e="function"==typeof window.showSaveFilePicker?w("button",{type:"button",class:"e",onclick:U,children:"Download"}):w("a",{role:"button",class:"e",ref:B,href:"#",children:"Download"});return w("fieldset",{children:e})},[F,O]=a(location.hash),T=F?O:o(6);history.pushState("","","#"+T),window.addEventListener("popstate",(()=>{const{hex:e}=u(),t=location.hash.slice(1);if(t!==e){const[e,n]=a(t);e&&h("set/hex",n)}})),h("set/hex",T),document.body.append(w((()=>w("main",{children:[w("h1",{children:"One pixel Base64 encoded GIF generator"}),w(x,{}),w(C,{}),w(S,{}),w(L,{}),w($,{}),w(D,{})]})),{})),s(),(()=>{const e=document.cookie.replace(/(?:(?:^|.*;\s*)cid\s*=\s*([^;]*).*$)|^.*$/,"$1"),t=""!==e?e:crypto.randomUUID();try{navigator.sendBeacon((e=>{const t=new URL("https://www.google-analytics.com/collect");for(const n in e)t.searchParams.set(n,e[n]);return t.href})({v:"1",ds:"web",tid:"UA-128241641-2",cid:t,t:"pageview",dr:document.referrer,dt:document.title,dl:location.origin+location.pathname,ul:navigator.language.toLowerCase(),sr:screen.width+"x"+screen.height,vp:visualViewport?.width+"x"+visualViewport?.height}))}catch{}document.cookie=`cid=${t};domain=shoonia.github.io;path=/;max-age=31536000`})();